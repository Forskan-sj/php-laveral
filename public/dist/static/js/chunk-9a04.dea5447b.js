(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9a04"],{"/yXQ":function(e,t,s){"use strict";var i=s("gDS+"),a=s.n(i),r={name:"UpLoad",props:{index:{required:!0,type:Number},type:{required:!0,type:Number},filelists:{required:!1,type:Array,default:function(){return[]}},singlePic:{required:!1,type:String,default:null},ossparas:{required:!0,type:Object}},data:function(){return{btnText:"点击上传",dialogImageUrl:"",alignSelf:{margin:"83px 0 0 30px"},dialogVisible:!1,fileStorage:[],ossKey:{},mediaDuration:-1,resLoaded:!1,showV:!1,vsource:"",imageUrl:"",fileType:["audio/mp3","video/mp4","image/jpeg,image/png","image/jpeg,image/png"]}},computed:{},updated:function(){if(this.resLoaded){this.resLoaded=!1;var e=document.getElementById("video-active"+this.index),t=this;e.onloadedmetadata=function(){t.$emit("uploadSucess",{mediaDuration:e.duration,index:t.index,type:t.type,res_url:null})}}},mounted:function(){this.ossKey=JSON.parse(a()(this.ossparas)),3===this.type&&null!=this.singlePic&&(this.imageUrl=this.singlePic,this.btnText="替换"),1!==this.type&&0!==this.type||null===this.singlePic||(this.vsource=this.singlePic,this.showV=!0,this.resLoaded=!0,this.btnText="替换")},methods:{handleRemove:function(e,t){var s=this,i=[];t.forEach(function(e,t,a){i.push(s.ossparas.key+"data"+e.uid+"."+e.name.split(".")[e.name.split(".").length-1])}),this.$emit("uploadSucess",{mediaDuration:this.mediaDuration,index:this.index,type:this.type,res_url:i})},handleAvatarSuccess:function(e,t,s){var i=this;if(console.log(t,s),this.$refs.upload.submit(),this.fileStorage=s,2!==this.type){this.btnText="替换",this.fileStorage=[t];var a=this.ossparas.key+"data"+t.uid+"."+t.name.split(".")[t.name.split(".").length-1];this.$emit("uploadSucess",{mediaDuration:this.mediaDuration,index:this.index,type:this.type,res_url:a})}if(3===this.type&&(this.imageUrl=this.ossparas.host+"/"+this.ossparas.key+"data"+t.uid+"."+t.name.split(".")[t.name.split(".").length-1]),2!==this.type&&3!==this.type&&(this.showV=!0,this.resLoaded=!0),2===this.type){var r=!0,o=[];s.forEach(function(e,t,s){"success"===e.status?o.push(i.ossparas.key+"data"+e.uid+"."+e.name.split(".")[e.name.split(".").length-1]):(r=!1,o=[])}),r&&this.$emit("uploadSucess",{mediaDuration:this.mediaDuration,index:this.index,type:this.type,res_url:o})}},beforeAvatarUpload:function(e){2!==this.type&&(this.showV=!1);var t=this.ossparas.key+"data"+e.uid+"."+e.name.split(".")[e.name.split(".").length-1];this.ossKey.key=t,this.vsource=this.ossparas.host+"/"+this.ossKey.key},handlePictureCardPreview:function(e){this.dialogImageUrl=1===e?this.imageUrl:e.url,this.dialogVisible=!0}}},o=(s("OXd6"),s("Z36Z"),s("KHd+")),l=Object(o.a)(r,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dndList"},[e.imageUrl?s("img",{staticClass:"avatar",staticStyle:{float:"left"},attrs:{src:e.imageUrl},on:{click:function(t){e.handlePictureCardPreview(1)}}}):e._e(),e._v(" "),e.showV?s("video",{staticClass:"video-active",attrs:{id:"video-active"+e.index,width:"320",height:"200",controls:"controls"}},[s("source",{attrs:{src:e.vsource,type:"video/mp4"}})]):e._e(),e._v(" "),s("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{"show-file-list":2==e.type,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"on-remove":e.handleRemove,"on-preview":e.handlePictureCardPreview,data:e.ossKey,multiple:2==e.type,accept:e.fileType[e.type],action:e.ossparas.host,"file-list":e.filelists,"list-type":2==e.type?"picture-card":""}},[2==e.type?s("i",{staticClass:"el-icon-plus"}):e._e(),e._v(" "),2!==e.type?s("el-button",{style:3!=e.type||null==e.singlePic&&!e.imageUrl?"":e.alignSelf,attrs:{size:"small",type:"success"},domProps:{textContent:e._s(e.btnText)}}):e._e()],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{attrs:{src:e.dialogImageUrl,width:"100%",alt:""}})])],1)},[],!1,null,"0a979296",null);l.options.__file="index.vue";t.a=l.exports},"2cco":function(e,t,s){"use strict";s.r(t);var i=s("gDS+"),a=s.n(i),r=s("/yXQ"),o=s("UMyc"),l={name:"MedalEdit",components:{UpLoad:r.a},data:function(){return{formMark:!1,path:"medal",ossParams:{},ulParamsMark:!1,listLoading:!1,listQuery:"",courseList:[],cdn:"https://cdncollege.quansuwangluo.com/",bEdit:!1,qrcodeList:[],form:{id:0,desc:"",title:"",img1:null,img2:null},formRules:{title:[{required:!0,message:"请选择所属专训",trigger:"blur"}],desc:[{required:!0,message:"请输入勋章描述",trigger:"blur"}],img1:[{required:!0,message:"请上传图片",trigger:"blur"}],img2:[{required:!0,message:"请上传灰图",trigger:"blur"}]}}},mounted:function(){var e=this;this.bEdit="0"!==this.$route.params.id,this.formMark=!1,this.getInfos(this.$route.params.id),Object(o.j)({type:"dev_test_dcaredata"}).then(function(t){e.ossParams=t.data.datas,e.ulParamsMark=!0,e.listLoading=!1})},methods:{getInfos:function(e){var t=this;this.listLoading=!0,Object(o.g)(this.path,{id:e}).then(function(e){t.formMark=!0,t.bEdit&&(t.form=e.data.datas.info),t.courseList=e.data.datas.special,t.listLoading=!1})},uploadSucess:function(e){null!==e.res_url&&3===e.type&&(-1===e.index&&(this.form.img1=e.res_url),-3===e.index&&(this.form.img2=e.res_url))},addCourse:function(){var e=this;this.listLoading=!0,Object(o.a)(this.path,this.form).then(function(t){e.listLoading=!1,e.$message(t.data.message),e.$store.dispatch("delView",e.$route),e.$router.replace("/medal/index"),sessionStorage.setItem("refresh",a()(1))})},onSubmit:function(e){var t=this;this.$refs.form.validate(function(e){e&&t.addCourse()})},onCancel:function(){this.$message({message:"cancel!",type:"warning"})}}},n=(s("f74y"),s("KHd+")),d=Object(n.a)(l,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[e.formMark?s("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"260px"}},[s("el-form-item",{attrs:{label:"勋章描述",prop:"desc"}},[s("el-input",{model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"所属专训",prop:"title"}},[s("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}},e._l(e.courseList,function(e){return s("el-option",{key:e.id,attrs:{label:e.title,value:e.title}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"勋章图片",prop:"img1"}},[e.ulParamsMark&&e.formMark?s("up-load",{attrs:{"single-pic":e.bEdit?e.cdn+e.form.img1:e.form.img1,index:-1,type:3,ossparas:e.ossParams},on:{uploadSucess:e.uploadSucess}}):e._e()],1),e._v(" "),s("el-form-item",{attrs:{label:"勋章灰图",prop:"img2"}},[e.ulParamsMark&&e.formMark?s("up-load",{attrs:{"single-pic":e.bEdit?e.cdn+e.form.img2:e.form.img2,index:-3,type:3,ossparas:e.ossParams},on:{uploadSucess:e.uploadSucess}}):e._e()],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")])],1)],1):e._e()],1)},[],!1,null,"4c1fc016",null);d.options.__file="options.vue";t.default=d.exports},Ms9V:function(e,t,s){},OXd6:function(e,t,s){"use strict";var i=s("uDfm");s.n(i).a},Z36Z:function(e,t,s){"use strict";var i=s("Ms9V");s.n(i).a},f74y:function(e,t,s){"use strict";var i=s("rjiy");s.n(i).a},rjiy:function(e,t,s){},uDfm:function(e,t,s){}}]);